---
title: 由重构进阶前端开发入门 (四) 面向对象
date: 2018-1-4 00:00:00
categories: [前端]
tags: [前端, 初学者, 面向对象]
toc: true
---

了解了在浏览器环境下，使用 JS 编程的基础概念之后，开始思考如何组织优化自己的代码，从编程技巧上提升开发和维护工作的效率吧。

<!-- more -->

> 相关文章：
>
> {% post_link basic-knowledge-points-for-beginner %}
> {% post_link basic-knowledge-points-for-beginner-1 %}
> {% post_link basic-knowledge-points-for-beginner-2 %}

# (四) 面向对象

## DRY (Don't Repeat Yourself) 原则

JavaScript 是一门编程语言，和其它计算机语言一样，在你编码的过程中需要有避免重复代码和逻辑的意识，注意不断优化自己的代码。

以免写出看似体系庞大而可靠，实则冗余且迟滞的代码，埋下 bug 隐患，影响团队伙伴阅读代码、协作开发的效率，也耽误自己以后优化和迭代项目。

因此，其中重要的原则之一就是 **DRY (Don't Repeat Yourself)** 原则。

当你第一次写下某段代码，之后在另一个地方又写下或粘贴同样的代码，你就应该有需要消除和提取重复代码的冲动了。等到第三次，再另一个地方又出现同样的代码时，就可以考虑行动起来，提取共用的代码而不是又重复一遍。

## 函数复用、公用库

例如，在页面某处有一个弹出 Dialog 的逻辑，写下了这样的代码：

```javascript
var $dialog1 = $('<p class="dialog-msg"></p>')
                .text('登陆成功！')
                .on('click','[close-dialog]', function () {
                  $(this).remove();
                });
$('body').append($dialog1);
```

之后又增加了一个类似的 Toast 消息：

```javascript
var $dialog2 = $('<p class="dialog-msg"></p>')
                .text('评论发送失败！')
                .on('click', '[close-dialog]', function () {
                  $(this).remove();
                });
$('body').append($dialog2);
```

这段代码与上面那段几乎所是相同的，区别只在于提示语。

明显没必要这样重复，可以提取出一个共用的函数：

```javascript
function showDialog(msg) {
  var $dialog = $('<p class="dialog-msg"></p>')
                  .text(msg)
                  .on('click', '[close-dialog]', function () {
                    $(this).remove();
                  });
  $('body').append($dialog);
}

showDialog('登陆成功！');

showDialog('评论发送失败！');
```

提取**共用函数**可以说是最基本的编程思想了。

这样之后需要增加新的消息，或是对原有的所有提示消息做调整和修复时，不需要修改散落在四处的代码，只需修改一处，效率大大提升。

有一些代码甚至不止可以用于一个项目，还可以在今后的项目开发中继续复用，这些函数逻辑可以提取成**公用代码库**，节省今后项目开发的时间。

## 抽象成对象/类

上面的思想概括起来，其实就是将处理一类事务的过程，以函数的形式复用。

是一种相对初级的复用思想，随着业务逻辑逐渐复杂，这种办法的效果也越来越弱。

结果就是，这样写出来的 js 文件，到达一定规模之后，其中虽然没什么重复代码，但却有着几十上百个函数。阅读者理清其中的顺序和关系会很耗时，难以保证可读性。

而且函数形式的复用，并不能很好的处理带属性、状态一类的情况。

比如上面的对话框函数，如果要给对话框增加拖动的处理函数，还要在记录坐标、层级、打开状态等等属性时，需要手动从外部传入很多变量来处理。

导致原本是对话框相关的逻辑和数据，却被分散到了文件内的不同地方，需要做属性增减时很难集中调整。

继续增加函数形式的控制逻辑，也容易与其他函数混在一起。项目合作的同事稍不注意，就容易插入其他函数把它们打散。

最后赶出来的项目或许能正常运行，但内部代码却是互相穿插、混乱不堪的**意大利面条代码**，几乎无法维护。

所以计算机软件工程的前人们，探索出了**面向对象**的编程思想。

